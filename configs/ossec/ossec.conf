<ossec_config>
  <!-- Enable email notifications if desired -->
  <global>
    <email_notification>no</email_notification> <!-- Set to 'yes' if you want email alerts -->
  </global>

  <!-- Enable active response -->
  <active-response>
    <enabled>yes</enabled>
    <command>host-deny</command>
    <timeout>60</timeout>
    <alert_level>7</alert_level>
  </active-response>

  <!-- Log monitoring -->
  <localfile>
    <log_format>syslog</log_format>
    <location>/var/log/auth.log</location>
  </localfile>

  <localfile>
    <log_format>syslog</log_format>
    <location>/var/log/syslog</location>
  </localfile>

  <localfile>
    <log_format>syslog</log_format>
    <location>/var/log/messages</location>
  </localfile>

  <!-- Enable rootkit detection -->
  <rootcheck>
    <disabled>no</disabled>
    <check_file>yes</check_file>
    <check_dir>yes</check_dir>
    <check_suid>yes</check_suid>
    <check_sgid>yes</check_sgid>
  </rootcheck>

  <!-- Enable File Integrity Monitoring -->
  <syscheck>
    <disabled>no</disabled>
    <frequency>43200</frequency>
    <scan_on_start>yes</scan_on_start>
    <directories>/etc,/bin,/sbin,/usr,/var</directories>
  </syscheck>

  <!-- Custom Rules -->
  <rules>
    <!-- Detecting Multiple Failed SSH Login Attempts -->
    <group name="ssh,">
      <rule id="100001" level="10">
        <decoded_as>syslog</decoded_as>
        <field name="program">sshd</field>
        <description>SSH login failure</description>
        <match>Failed password</match>
        <frequency>5</frequency>
        <timeframe>120</timeframe>
        <alert_by_email>yes</alert_by_email>
        <response>command</response>
      </rule>
    </group>

    <!-- Detecting Suspicious File Changes in /etc -->
    <group name="syscheck,">
      <rule id="100002" level="10">
        <decoded_as>syscheck</decoded_as>
        <description>Suspicious file change detected in /etc</description>
        <match>/etc/passwd|/etc/shadow|/etc/group</match>
        <alert_by_email>yes</alert_by_email>
        <response>command</response>
      </rule>
    </group>

    <!-- Detecting Unauthorized User Additions -->
    <group name="auth,">
      <rule id="100003" level="10">
        <decoded_as>syslog</decoded_as>
        <field name="program">useradd</field>
        <description>Unauthorized user addition</description>
        <match>useradd</match>
        <alert_by_email>yes</alert_by_email>
        <response>command</response>
      </rule>
    </group>

    <!-- Detecting Suspicious Sudo Commands -->
    <group name="sudo,">
      <rule id="100004" level="10">
        <decoded_as>syslog</decoded_as>
        <field name="program">sudo</field>
        <description>Suspicious sudo command execution</description>
        <match>sudo rm -rf /</match>
        <alert_by_email>yes</alert_by_email>
        <response>command</response>
      </rule>
    </group>

    <!-- Detecting High Number of Connections from a Single IP -->
    <group name="firewall,">
      <rule id="100005" level="10">
        <decoded_as>syslog</decoded_as>
        <field name="program">iptables</field>
        <description>High number of connections from a single IP</description>
        <match>DPT=22</match>
        <frequency>20</frequency>
        <timeframe>60</timeframe>
        <alert_by_email>yes</alert_by_email>
        <response>command</response>
      </rule>
    </group>

    <!-- Detecting ARP Spoofing -->
    <group name="network,">
      <rule id="100006" level="10">
        <decoded_as>syslog</decoded_as>
        <description>ARP spoofing detected</description>
        <match>ARP</match>
        <alert_by_email>yes</alert_by_email>
        <response>command</response>
      </rule>
    </group>

    <!-- Detecting Suspicious DNS Responses -->
    <group name="network,">
      <rule id="100007" level="10">
        <decoded_as>syslog</decoded_as>
        <description>Unexpected DNS response detected</description>
        <match>DNS</match>
        <alert_by_email>yes</alert_by_email>
        <response>command</response>
      </rule>
    </group>
  </rules>

  <!-- Network Configuration Monitoring -->
  <localfile>
    <log_format>syslog</log_format>
    <location>/var/log/arpwatch.log</location>
  </localfile>

</ossec_config>
